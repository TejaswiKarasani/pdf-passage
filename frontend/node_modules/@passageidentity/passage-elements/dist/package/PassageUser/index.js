"use strict";var y=Object.create;var d=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var k=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var A=(s,e)=>{for(var r in e)d(s,r,{get:e[r],enumerable:!0})},h=(s,e,r,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of I(e))!b.call(s,n)&&n!==r&&d(s,n,{get:()=>e[n],enumerable:!(t=w(e,n))||t.enumerable});return s};var S=(s,e,r)=>(r=s!=null?y(k(s)):{},h(e||!s||!s.__esModule?d(r,"default",{value:s,enumerable:!0}):r,s)),T=s=>h(d({},"__esModule",{value:!0}),s);var P=(s,e,r)=>{if(!e.has(s))throw TypeError("Cannot "+r)};var a=(s,e,r)=>(P(s,e,"read from private field"),r?r.call(s):e.get(s)),g=(s,e,r)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,r)},l=(s,e,r,t)=>(P(s,e,"write to private field"),t?t.call(s,r):e.set(s,r),r);var U={};A(U,{PassageUser:()=>c});module.exports=T(U);var o=require("@passageidentity/passage-js"),m=S(require("jwt-decode"));var p=class extends o.ReadOnlyTokenStore{constructor(r){super();this.externalToken=r}getAuthToken(){return Promise.resolve(this.externalToken)}},u,i,c=class{constructor(e){g(this,u,void 0);g(this,i,void 0);let r,t;e!==void 0?(r=e,t=new p(r)):r=localStorage.getItem("psg_auth_token");let n=this._getAppId(r),f=new o.Passage(n,{tokenStore:t});l(this,u,f.getCurrentUser()),l(this,i,f.getCurrentSession())}_getAppId(e){let r=new o.PassageError("No Passsage authToken found",{status:o.PassageErrorCode.PSGLoginRequired,statusText:"Login required"});if(e===null)throw r;let t=(0,m.default)(e);if(t!==void 0&&t.aud!==void 0&&Array.isArray(t.aud)&&t.aud[1]!==void 0)return t.aud[1];if(t!==void 0&&t.iss!==void 0){let n=t.iss.split("/");return n[n.length-1]}throw r}authGuard(){return a(this,i).authGuard()}async userInfo(){return a(this,u).userInfo()}async signOut(){return a(this,i).signOut()}async getAuthToken(){return a(this,i).getAuthToken()}async refresh(){return(await a(this,i).refresh()).auth_token}};u=new WeakMap,i=new WeakMap;0&&(module.exports={PassageUser});
//# 