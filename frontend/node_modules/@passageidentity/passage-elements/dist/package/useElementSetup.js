"use strict";var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,l=(e,t,n)=>new Promise(((a,i)=>{var o=e=>{try{l(n.next(e))}catch(t){i(t)}},r=e=>{try{l(n.throw(e))}catch(t){i(t)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(o,r);l((n=n.apply(e,t)).next())})),s=require("./customElements.js"),c=require("./useUpdateUser.js"),u=(e=>(e.phone="PHONE",e.email="EMAIL",e))(u||{});function d(){const e=s.ref();return s.watch(e,(()=>{void 0!==e.value&&null!==e.value&&e.value.focus()})),{autofocusButton:e}}const p={class:"identifier-form"},f={class:"has-text-centered"},v=s.createBaseVNode("br",null,null,-1),m=["onSubmit"],g=["autocomplete","inputmode","placeholder","onInput"],h={class:"flex-row flex-center"},y=["onClick"],k={key:0,style:{"margin-top":"30px"},class:"link has-text-centered"},B=["onClick"],b=s.defineComponent({__name:"ValidatedIdentifierForm",props:{appId:{},validationError:{default:""},identifier:{},countryCode:{},identifierMode:{},showWelcomeBack:{type:Boolean,default:!1},conditionalUI:{type:Boolean,default:!1}},emits:["onSubmit","update:validationError","update:identifier","update:countryCode","update:showWelcomeBack"],setup(e,{emit:t}){const n=e,{t:a}=s.useLocale(),i=s.ref(""),o=s.ref(),r=s.ref(),{autofocusButton:b}=d(),w=s.computed((()=>n.showWelcomeBack)),I=s.computed((()=>{let e;switch(n.identifierMode){case s.oe.phone:e=a("phone-number");break;case s.oe.email:e=a("email-address");break;case s.oe.both:e=a("email-or-phone-number")}return e.charAt(0).toUpperCase()+e.slice(1)})),C=s.computed((()=>"example@email.com")),V=s.computed((()=>n.identifierMode===s.oe.phone?"tel":"email")),N=s.computed((()=>{var e;return n.conditionalUI?`${V.value} webauthn`:null!=(e=V.value)?e:""})),x=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}});function S(){var e;if(!x.value)return"";let t=x.value;return w.value||(t=T()?null!=(e=null==A?void 0:A.getNumber())?e:"":x.value),t.trim().toLowerCase()}const _=s.computed((()=>s.isStringNullish(n.validationError)?s.isStringNullish(i.value)?"":i.value:n.validationError));function E(){i.value="",t("update:validationError","")}function D(){return l(this,null,(function*(){if(!function(){if(""===S()){let e="";switch(n.identifierMode){case s.oe.phone:e=a("enter-a-phone-number");break;case s.oe.email:e=a("enter-an-email-address");break;case s.oe.both:e=a("enter-an-email-or-phone-number")}return i.value=e,!1}if(n.identifierMode===s.oe.email&&!L())return i.value=a("enter-a-valid-email-address"),!1;if(n.identifierMode===s.oe.phone&&!T())return i.value=a("enter-a-valid-phone-number"),!1;if(n.identifierMode===s.oe.both&&!T()&&!L())return i.value=a("enter-a-valid-email-or-phone-number"),!1;return!0}())return;const e=new s.Y(n.appId);let o,r,l,c,d,p=!1,f="";try{const t=yield e.identifierExists(S());null!==t?(o=!0,r=t.webauthn,d=t.status,f=t.id,c=t.email_verified,p=t.phone_verified,l=t.webauthn_types.includes(s.E.Passkey)):(o=!1,r=!1,d=s.te.INACTIVE)}catch(v){let e;switch(n.identifierMode){case s.oe.email:e=a("enter-a-valid-email-address");break;case s.oe.phone:e=a("enter-a-valid-phone-number");break;case s.oe.both:e=a("enter-a-valid-email-or-phone-number")}return void(i.value=e)}t("onSubmit",{identifier:S(),identifierExists:o,identifierType:T()?u.phone:u.email,userHasWebauthn:r,userStatus:d,userID:f,emailVerified:c,phoneVerified:p,userHasPasskey:l})}))}function L(){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(S())}function T(){return w.value?R():void 0!==A&&A.isValidNumber()}let A;function M(){void 0===A&&(o.value.addEventListener("countrychange",(()=>{var e;t("update:countryCode",null!=(e=null==A?void 0:A.getSelectedCountryData().iso2)?e:"")})),A=c.intlTelInput(o.value,{initialCountry:n.countryCode,utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",dropdownContainer:r.value,autoPlaceholder:"aggressive"}),o.value.focus())}function R(){return/^\+$|^\+?[0-9,(,),\-, ]+$/.test(x.value.trim())}s.onMounted((()=>{n.conditionalUI&&function(){const e=P.value.getRootNode().host;void 0!==e&&(P.value.appendChild(function(){const e=document.createElement("style");return e.appendChild(document.createTextNode("\n      .psg-input{\n        -webkit-appearance: none;\n        -moz-appearance: none;\n        box-sizing: border-box;\n        color: var(--passage-body-text-color, #000000);\n        font-family: var(--passage-body-font-family, 'Helvetica');\n        font-size: var(--passage-body-font-size, 14px);\n        font-weight: var(--passage-body-font-weight, 400);\n\n        min-height: 40px;\n        width: 100%;\n\n        padding-left: 10px;\n        padding-right: 10px;\n        margin: 0;\n\n        color: var(--app-text);\n\n        background-color: var(--passage-container-background-color, #ffffff);\n        border-style: solid;\n        border-color: var(--passage-control-border-color, #d7d7d7);\n        border-width: 1px;\n        border-radius: var(--passage-control-border-radius, 5px);\n\n        transition: all 0.3s;\n\n        text-overflow: ellipsis;\n      }\n\n      .psg-input:focus{\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-body-text-color, #000000);\n      }\n\n      .psg-input:active{\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-body-text-color, #000000);\n      }\n\n      .psg-input.has-error{\n        border-color: var(--passage-error-color, #dd0031);\n      }\n      .psg-input.is-danger{\n        border-color: var(--passage-error-color, #dd0031);\n      }\n      .iti {\n        width: 100%;\n      }\n\n        .iti__country-list {\n            border-radius: 6px;\n        }\n\n        .iti__country {\n            padding: 5px 10px;\n        }\n\n        .iti__selected-flag {\n            border-top-left-radius: var(--passage-control-border-radius, 6px);\n            border-bottom-left-radius: var(--passage-control-border-radius, 6px);\n        }\n\n    .iti--container {\n        top: unset !important;\n        left: unset !important;\n    }")),e}()),P.value.appendChild(function(){const e=document.createElement("link");return e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.16/css/intlTelInput.css",e}()),e.appendChild(P.value))}(),n.identifierMode===s.oe.phone&&M()})),n.identifierMode===s.oe.both&&s.watch(x,(()=>{R()?M():void 0!==A&&(A.destroy(),A=void 0,o.value&&o.value.focus())}));const U=s.computed((()=>n.countryCode));function F(){t("update:showWelcomeBack",!1),x.value=""}s.watch(U,(e=>{null==A||A.setCountry(e)}));const P=s.ref();return s.onBeforeUnmount((()=>{P.value.remove()})),(e,t)=>(s.openBlock(),s.createElementBlock("div",p,[s.withDirectives(s.createBaseVNode("div",f,[s.createTextVNode(s.toDisplayString(s.unref(a)("welcome-back-sign-in-as")),1),v,s.createBaseVNode("strong",null,s.toDisplayString(x.value),1)],512),[[s.vShow,e.showWelcomeBack]]),s.withDirectives(s.createBaseVNode("div",null,[s.createBaseVNode("div",{class:"label",ref:"labelRef"},s.toDisplayString(I.value),513),s.createBaseVNode("form",{ref_key:"identifierForm",ref:P,slot:"loginInput",onSubmit:s.withModifiers(D,["prevent"])},[s.withDirectives(s.createBaseVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.value=e),type:"text",class:s.normalizeClass(["input psg-input",{"is-danger":_.value}]),part:"input",autocomplete:N.value,inputmode:V.value,id:"identifier",placeholder:C.value,onInput:s.withModifiers(E,["prevent"]),"data-test":"identifier-input",ref_key:"identifierInput",ref:o},null,42,g),[[s.vModelText,x.value]])],40,m),s.renderSlot(e.$slots,"loginInput")],512),[[s.vShow,!e.showWelcomeBack]]),s.createBaseVNode("div",{ref_key:"controlContainer",ref:r,style:{width:"100%"}},null,512),s.createBaseVNode("div",{style:s.normalizeStyle(`text-align: ${w.value?"center":"left"};`),class:"help is-danger error-message","data-test":"validation-error"},s.toDisplayString(_.value),5),s.renderSlot(e.$slots,"metadataFields"),s.createBaseVNode("div",h,[s.createBaseVNode("button",{class:"button is-primary",part:"button","data-test":"continue-button",ref_key:"autofocusButton",ref:b,onClick:s.withModifiers(D,["prevent"])},s.toDisplayString(s.unref(a)("continue")),9,y)]),w.value?(s.openBlock(),s.createElementBlock("div",k,[s.createBaseVNode("a",{onClick:s.withModifiers(F,["prevent"]),role:"button","data-test":"register-link"},s.toDisplayString(s.unref(a)("switch-account")),9,B)])):s.createCommentVNode("",!0)]))}});var w=(e=>(e.onLoaded="onLoaded",e.onRegisterDevice="onRegisterDevice",e.onVerifyIdentity="onVerifyIdentity",e.onMagicLinkLogin="onMagicLinkLogin",e.onMagicLinkRegister="onMagicLinkRegister",e.onMagicLinkActivated="onMagicLinkActivated",e.onMagicLinkActivateSuccess="onMagicLinkActivateSuccess",e.onOneTimePasscodeLogin="onOneTimePasscodeLogin",e.onOneTimePasscodeRegister="onOneTimePasscodeRegister",e.onOneTimePasscodeActivated="onOneTimePasscodeActivated",e.onOneTimePasscodeActivateSuccess="onOneTimePasscodeActivateSuccess",e))(w||{});const I=()=>!0,C=e=>{window.location.href=e.redirect_url},V=()=>{},N=s.ref(I),x=s.ref(C),S=s.ref(V);function _(e){N.value=void 0!==e?e:I}function E(e){x.value=void 0!==e?e:C}function D(e){S.value=void 0!==e?e:V}function L(){return{beforeAuth:s.readonly(N),onSuccess:s.readonly(x),onEvent:s.readonly(S),setBeforeAuth:_,setOnSuccess:E,setOnEvent:D}}function T(e,t){return l(this,null,(function*(){const{browserFeatures:n,appInfo:a,router:i}=t,{appId:o}=s.useAppId(),r=new s.Y(o.value),{emitEvent:l}=j(),{identifier:c,identifierType:d,userHasPasskey:p,userHasWebauthn:f,emailVerified:v,phoneVerified:m,userID:g}=e,h=a.auth_fallback_method===s.ue.None;if(!f&&h)return void i.push(Ba);const y=function(e,t,n,a){if(e.require_identifier_verification&&(a===u.email&&!t||a===u.phone&&!n))return!0;return!1}(a,v,m,d),k=n.platform&&f&&r.credIDExists(g),B=n.syncedCredential&&p,b=n.platform&&h,I=p&&n.platform&&!navigator.credentials.get.toString().includes("[native code]");!y&&(B||k||b||I)?(L().onEvent.value(w.onVerifyIdentity),i.push(ma,{identifier:c,identifierType:d,appInfo:a})):l({type:R.FallbackAuth,payload:{identifier:c,identifierType:d,userInitiated:!1,identifierVerifying:y,setupNewDevice:n.platform}})}))}function A(e,t){const{authState:n,appInfo:a,router:i}=t;switch(n.userInitiatedFallback=e.userInitiated,a.auth_fallback_method){case s.ue.LoginCode:!function(e){const{identifier:t,userIsRegistering:n}=e;n?L().onEvent.value(w.onOneTimePasscodeRegister,{identifier:t}):L().onEvent.value(w.onOneTimePasscodeLogin)}(e),i.push(ha,e);break;case s.ue.MagicLink:!function(e){const{identifier:t,userIsRegistering:n}=e;n?L().onEvent.value(w.onMagicLinkRegister,{identifier:t}):L().onEvent.value(w.onMagicLinkLogin)}(e),i.push(va,e);break;case s.ue.None:i.push(ka)}}function M(e){return l(this,null,(function*(){s.isStringNullish(e.authResult.auth_token)||s.isStringNullish(e.authResult.redirect_url)||(yield function(e){return l(this,null,(function*(){if(e&&"string"==typeof e)return void localStorage.setItem("psg_last_login",e);let t=e;if(void 0===e){const{appId:e}=s.useAppId(),n=new s.Y(e.value);t=yield n.getCurrentUser().userInfo()}void 0!==t&&localStorage.setItem("psg_last_login",t.email?t.email:t.phone)}))}(e.identifier),L().onSuccess.value(e.authResult))}))}var R=(e=>(e.CreatedUser="CreatedUser",e.ChangeIdentifier="ChangeIdentifier",e.LoginUser="LoginUser",e.FallbackAuth="FallbackAuth",e.AuthSuccess="AuthSuccess",e.FallbackAuthSuccess="FallbackAuthSuccess",e))(R||{});class U{constructor(e,t){this.appInfo=e,this.router=t,this.authState={userInitiatedFallback:!1},this.authOriginValid=!1,this.browserFeatures={securityKey:!1,platform:!1,syncedCredential:!1,crossDeviceCredential:!1,conditionalUI:!1,isAvailable:!1}}initializeEventHandler(){return l(this,null,(function*(){const{appId:e}=s.useAppId(),t=new s.Y(e.value);this.authOriginValid=t.checkWebauthnConfig(this.appInfo),this.authOriginValid&&(this.browserFeatures=yield t.getCredentialAvailable(),function(){const e=new s.UAParser;return"Safari"==e.getBrowser().name&&parseFloat(e.getBrowser().version||"")<16.4}()&&(this.browserFeatures.conditionalUI=!1)),this.checkMagicLink()||this.router.push(this.router.homeRoute,{appInfo:this.appInfo,conditionalUI:this.browserFeatures.conditionalUI})}))}handleEvent(e){return l(this,null,(function*(){switch(e.type){case"CreatedUser":!function(e,t){const{webauthnAllowed:n,appInfo:a,router:i}=t,{identifier:o,identifierType:r}=e,{emitEvent:l}=j();n&&!a.require_identifier_verification?(L().onEvent.value(w.onRegisterDevice,{identifier:o}),i.push(fa,{identifier:o,identifierType:r,appInfo:a})):l({type:R.FallbackAuth,payload:{identifier:o,identifierType:r,identifierVerifying:a.require_identifier_verification,userIsRegistering:!0,userInitiated:!1}})}(e.payload,this.eventHandlerState);break;case"ChangeIdentifier":!function(e){const{appInfo:t,router:n,browserFeatures:a}=e;n.push(n.homeRoute,{appInfo:t,conditionalUI:a.conditionalUI,changeEmail:!0})}(this.eventHandlerState);break;case"LoginUser":T(e.payload,this.eventHandlerState);break;case"FallbackAuth":A(e.payload,this.eventHandlerState);break;case"AuthSuccess":M(e.payload);break;case"FallbackAuthSuccess":!function(e,t){const{webauthnAllowed:n,authState:a,router:i}=t;!n||a.userInitiatedFallback?j().emitEvent({type:R.AuthSuccess,payload:e}):i.push(ya,e)}(e.payload,this.eventHandlerState)}}))}get eventHandlerState(){return{appInfo:this.appInfo,webauthnAllowed:this.browserFeatures.platform,router:this.router,authState:this.authState,browserFeatures:this.browserFeatures}}checkMagicLink(){const e=window.location.search,t=new URLSearchParams(e);let n=null;return t.has("psg_magic_link")?n=t.get("psg_magic_link"):t.has("psg_verify_link")&&(n=t.get("psg_verify_link")),null!==n&&(this.router.push(ga,{magicLink:n,webauthnAllowed:this.browserFeatures.platform}),!0)}}let F;function P(e,t){return l(this,null,(function*(){F=new U(e,t),yield F.initializeEventHandler()}))}function O(){return F}function $(e){return l(this,null,(function*(){return null==F?void 0:F.handleEvent(e)}))}function j(){return{initEventHandler:P,getEventHandler:O,emitEvent:$}}const H=s.defineComponent({__name:"Login",props:{canToggleLoginRegister:{type:Boolean},identifier:{},countryCode:{},appInfo:{},visible:{type:Boolean},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},emits:["update:identifier","update:countryCode"],setup(e,{emit:t}){const n=e,{appId:a}=s.useAppId(),{t:i}=s.useLocale(),o=s.ref(""),r=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}}),c=s.computed({get:()=>n.countryCode,set(e){t("update:countryCode",e)}}),d=s.ref();s.watch(d,(()=>l(this,null,(function*(){L().onEvent.value(w.onLoaded),g()}))));const p=s.computed((()=>{var e;return null!=(e=n.appInfo.allowed_identifier)?e:s.oe.email}));function f(e){return l(this,null,(function*(){const{identifier:t,identifierExists:a,userHasWebauthn:r,userHasPasskey:l,userStatus:c,userID:d,identifierType:p,emailVerified:f,phoneVerified:v}=e;if(!L().beforeAuth.value(t))return;const m=function(e,t,a){if(!e){let e=t===u.email?i("email"):i("phone");e=`${e.charAt(0).toUpperCase()}${e.slice(1)}`;let a=`${i("not-recognized",[e])}.`;return n.canToggleLoginRegister&&n.appInfo.public_signup&&(a=`${a} ${i("toggle-register")}`),a}if(e&&a===s.te.INACTIVE)return i("account-no-longer-active");return""}(a,p,c);""===m?j().emitEvent({type:R.LoginUser,payload:{identifier:t,identifierType:p,userHasPasskey:l,userHasWebauthn:r,userID:d,emailVerified:f,phoneVerified:v}}):o.value=m}))}const v=s.ref(!1);let m;function g(){return l(this,null,(function*(){if(n.conditionalUI){m=new AbortController;new s.Y(a.value).loginConditional(m.signal).then((e=>{j().emitEvent({type:R.AuthSuccess,payload:{authResult:e}})})).catch((()=>{}))}}))}function h(){null==m||m.abort()}return s.onMounted((()=>{const e=localStorage.getItem("psg_last_login");e&&!n.changeEmail&&(r.value=e,v.value=!0)})),s.onBeforeUnmount((()=>{h()})),s.watch((()=>n.visible),(()=>{!0===v.value&&(r.value=""),v.value=!1,n.visible?g():h()})),(e,t)=>(s.openBlock(),s.createBlock(b,{appId:s.unref(a),identifierMode:p.value,conditionalUI:e.conditionalUI,showWelcomeBack:v.value,"onUpdate:showWelcomeBack":t[0]||(t[0]=e=>v.value=e),identifier:r.value,"onUpdate:identifier":t[1]||(t[1]=e=>r.value=e),validationError:o.value,"onUpdate:validationError":t[2]||(t[2]=e=>o.value=e),countryCode:c.value,"onUpdate:countryCode":t[3]||(t[3]=e=>c.value=e),onOnSubmit:t[4]||(t[4]=e=>f(e)),ref_key:"inputForm",ref:d},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["appId","identifierMode","conditionalUI","showWelcomeBack","identifier","validationError","countryCode"]))}}),z={key:0,class:"notification is-danger has-text-centered","data-test":"invalid-app-id"},W=s.defineComponent({__name:"Register",props:{canToggleLoginRegister:{type:Boolean},identifier:{},countryCode:{},appInfo:{}},emits:["update:identifier","update:countryCode","authEvent"],setup(e,{emit:t}){const n=e,{t:a}=s.useLocale(),{appId:i}=s.useAppId(),{emitEvent:o}=j(),r=s.ref(""),d=s.computed({get:()=>n.identifier,set(e){t("update:identifier",e)}}),p=s.computed({get:()=>n.countryCode,set(e){t("update:countryCode",e)}}),f=s.computed((()=>n.appInfo.public_signup)),v=s.computed((()=>n.appInfo.allowed_identifier));const m=s.ref({}),g=s.ref();return(e,t)=>(s.openBlock(),s.createElementBlock("div",null,[s.createVNode(b,{appId:s.unref(i),identifierMode:v.value,identifier:d.value,"onUpdate:identifier":t[0]||(t[0]=e=>d.value=e),validationError:r.value,"onUpdate:validationError":t[1]||(t[1]=e=>r.value=e),countryCode:p.value,"onUpdate:countryCode":t[2]||(t[2]=e=>p.value=e),onOnSubmit:t[3]||(t[3]=e=>function(e){return l(this,null,(function*(){const{identifier:t,identifierExists:l,userStatus:d,identifierType:p}=e;if(!L().beforeAuth.value(t))return;let f=!0;if(g.value&&(f=g.value.validate()),l){if(d===s.te.ACTIVE){let e=a("account-already-exists",[p===u.email?a("email"):a("phone-number")]);return n.canToggleLoginRegister&&(e=e+" "+a("toggle-login")),void(r.value=e)}if(d===s.te.INACTIVE)return void(r.value=a("account-no-longer-active"))}const v=new s.Y(i.value);if(f){try{yield v.createUser({identifier:t,user_metadata:c.transformMetadata(m.value,n.appInfo.user_metadata_schema,!0)})}catch(h){return void(h instanceof s.h&&h.message.startsWith("Public signup")?r.value=h.message:r.value=a("unexpected-error"))}o({type:R.CreatedUser,payload:{identifier:t,identifierType:p}})}}))}(e))},{metadataFields:s.withCtx((()=>[e.appInfo&&e.appInfo.layouts.registration.length>0?(s.openBlock(),s.createBlock(c.UserMetadata,{key:0,isEditing:!0,appInfo:e.appInfo,layoutType:s.unref(c.LayoutType).Registration,userMetadata:m.value,ref_key:"metadataComponent",ref:g},null,8,["appInfo","layoutType","userMetadata"])):s.createCommentVNode("",!0)])),_:1},8,["appId","identifierMode","identifier","validationError","countryCode"]),f.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",z,s.toDisplayString(s.unref(a)("public-registration-not-allowed")),1))]))}});class Y{newEphemeralApp(){return l(this,null,(function*(){const e=yield fetch("https://api.passage.id/v1/apps/",{method:"POST",body:JSON.stringify({auth_origin:window.location.origin,name:"Ephemeral Random "+(1e6*Math.random()).toString()})}),t=yield e.json();if(200!==e.status)throw t.message;return localStorage.setItem("psg_ephemeral_app_id",t.app.id),localStorage.setItem("psg_ephemeral_app_name",t.app.name),t}))}}const q=s.defineComponent({name:"EphemeralAppInfo",setup(){const e="https://console.passage.id",{t:t}=s.useLocale(),n=s.ref(!1),a=s.ref(!1),i=s.ref(!1),o=s.ref(""),r=s.ref(""),c=()=>l(this,null,(function*(){const{appIdUnassigned:t,updateAppId:i}=s.useAppId();if(t.value){a.value=!0;const t=localStorage.getItem("psg_ephemeral_app_id"),l=localStorage.getItem("psg_ephemeral_app_name");if(t){const n=l?`?name=${encodeURIComponent(l)}`:"";o.value=`${e}/claim/${t}${n}`,i(t),d()}else try{const t=new Y,n=yield t.newEphemeralApp();i(n.app.id);const a=n.app.name?`?name=${encodeURIComponent(n.app.name)}`:"";o.value=`${e}/claim/${n.app.id}${a}`,d()}catch(r){n.value=!0,i("")}}})),u=()=>l(this,null,(function*(){const{appId:e}=s.useAppId();if(!a.value)return;const t=new s.Y(e.value);try{(yield t.appInfo()).ephemeral||(i.value=!0,r.value=`<passage-auth app-id="${e.value}"/>`)}catch(o){n.value=!0}}));function d(){const{appId:e}=s.useAppId();console.info(`Passage Test App ID: ${e.value}`),console.info(`Claim your app: ${o.value}`)}return s.onBeforeMount((()=>l(this,null,(function*(){yield c(),yield u()})))),{error:n,isEphemeral:a,claimed:i,ephemeralClaimUrl:o,exampleTag:r,t:t}}}),K={key:0},G={key:0,class:"notification is-danger"},Z={key:1,class:"notification ephemeral-box","data-test":"ephemeral-app-message"},J={key:0},Q=["href"],X={key:1},ee=s.createBaseVNode("br",null,null,-1);var te=s._export_sfc(q,[["render",function(e,t,n,a,i,o){return e.isEphemeral?(s.openBlock(),s.createElementBlock("div",K,[e.error?(s.openBlock(),s.createElementBlock("div",G,s.toDisplayString(e.t("unable-to-create-test-app")),1)):(s.openBlock(),s.createElementBlock("div",Z,[e.claimed?(s.openBlock(),s.createElementBlock("div",X,[s.createTextVNode(s.toDisplayString(e.t("add-your-claimed-app-like-this"))+" ",1),ee,s.createTextVNode(s.toDisplayString(e.exampleTag),1)])):(s.openBlock(),s.createElementBlock("div",J,[s.createTextVNode(s.toDisplayString(e.t("currently-using-test-app"))+" ",1),s.createBaseVNode("a",{href:e.ephemeralClaimUrl,target:"_blank"},s.toDisplayString(e.t("click-here")),9,Q),s.createTextVNode(".")]))]))])):s.createCommentVNode("",!0)}]]);const ne={key:0,class:"link has-text-centered"},ae={class:"passage-branding"},ie={href:"https://passage.1password.com/",target:"_new_tab"},oe=s.defineComponent({__name:"PassageBranding",props:{appInfo:{}},setup:e=>(e,t)=>e.appInfo.passage_branding?(s.openBlock(),s.createElementBlock("div",ne,[s.createBaseVNode("div",ae,[s.createBaseVNode("a",ie,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).poweredByPassage,alt:"Powered by Passage Icon"},null,8,["src"])])])])):s.createCommentVNode("",!0)}),re={class:"view-email-input"},le={class:"auth-flex-container"},se={class:"title main-title has-text-centered"},ce=s.createBaseVNode("div",{style:{height:"20px"}},null,-1),ue={class:"spacer"},de={class:"link has-text-centered"},pe={key:0},fe=["onClick"],ve={key:1},me=["onClick"],ge=s.defineComponent({__name:"AuthView",props:{register:{type:Boolean},appInfo:{},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},setup(e){const t=e,{t:n}=s.useLocale(),a=s.ref(!t.register),i=s.ref(""),{defaultCountryCode:o}=s.useDefaultCountryCode(),r=o,l=s.computed((()=>t.appInfo.public_signup));function c(){a.value=!a.value}return(e,t)=>(s.openBlock(),s.createElementBlock("div",re,[s.createBaseVNode("div",le,[s.createBaseVNode("div",se,s.toDisplayString(a.value?s.unref(n)("login-title"):s.unref(n)("register-title")),1),ce,s.withDirectives(s.createVNode(H,{identifier:i.value,"onUpdate:identifier":t[0]||(t[0]=e=>i.value=e),canToggleLoginRegister:!0,countryCode:s.unref(r),"onUpdate:countryCode":t[1]||(t[1]=e=>s.isRef(r)?r.value=e:null),appInfo:e.appInfo,visible:a.value,conditionalUI:e.conditionalUI,changeEmail:e.changeEmail},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["identifier","countryCode","appInfo","visible","conditionalUI","changeEmail"]),[[s.vShow,a.value]]),s.withDirectives(s.createVNode(W,{identifier:i.value,"onUpdate:identifier":t[2]||(t[2]=e=>i.value=e),canToggleLoginRegister:!0,countryCode:s.unref(r),"onUpdate:countryCode":t[3]||(t[3]=e=>s.isRef(r)?r.value=e:null),appInfo:e.appInfo},null,8,["identifier","countryCode","appInfo"]),[[s.vShow,!a.value]]),s.createBaseVNode("div",ue,[s.createVNode(te)]),s.createBaseVNode("div",de,[a.value&&l.value?(s.openBlock(),s.createElementBlock("div",pe,[s.createTextVNode(s.toDisplayString(s.unref(n)("dont-have-an-account"))+" ",1),s.createBaseVNode("a",{onClick:s.withModifiers(c,["prevent"]),role:"button","data-test":"register-link"},s.toDisplayString(s.unref(n)("register-here")),9,fe)])):a.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",ve,[s.createTextVNode(s.toDisplayString(s.unref(n)("already-have-an-account"))+" ",1),s.createBaseVNode("a",{onClick:s.withModifiers(c,["prevent"]),role:"button","data-test":"login-link"},s.toDisplayString(s.unref(n)("login-here")),9,me)]))])]),s.createVNode(oe,{"app-info":e.appInfo},null,8,["app-info"])]))}});var he=(e=>(e.LOGIN="psg_magic_link",e.VERIFY="psg_verify_link",e))(he||{});const ye=({magicLink:e,uiState:t,magicLinkUtils:n,passage:a})=>{const i=s.ref(null),o=()=>{t.uiLoading(),i.value={auth_token:"",redirect_url:""}},r=()=>{t.uiError()},c=()=>{n.invalidMagicLink.value=!0,t.uiError()},u=e=>l(this,[e],(function*({webauthnAllowed:e,magicLinkAction:n,result:a}){i.value=a,e&&n!==he.VERIFY||(t.uiSuccess(),yield new Promise((e=>{setTimeout(e,2e3)}))),i.value.redirect_url&&j().emitEvent({type:n===he.VERIFY?R.AuthSuccess:R.FallbackAuthSuccess,payload:{authResult:a}})}));return{authResult:i,onBeforeActivate:o,onActivateError:r,onActivateErrorInvalidMagicLink:c,onActivateSuccess:u,activateWithoutBiometrics:(t,n)=>l(this,null,(function*(){o();try{const i=yield a.magicLinkActivate(e);u({webauthnAllowed:t,magicLinkAction:n,result:i})}catch(i){i.statusCode===s.T.NotFound?c():r()}}))}},ke={class:"auth-flex-container"},Be={class:"image has-text-centered"},be={class:"content has-text-centered","data-test":"activate-magic-link-message"},we={key:0},Ie={key:1},Ce={key:2},Ve={key:3},Ne={key:4},xe={key:0,class:"flex-row flex-center",style:{padding:"20px 0px"}},Se=["onClick","disabled"],_e={key:0},Ee={key:1},De={key:2},Le=s.defineComponent({__name:"ActivateMagicLink",props:{magicLink:{},webauthnAllowed:{type:Boolean}},setup(e){const t=e,{t:n}=s.useLocale(),{appId:a}=s.useAppId(),i=new s.Y(a.value),o=function(){const e=s.ref(!1),t=s.ref(!1),n=s.ref(!1),a=s.ref(!0),{t:i}=s.useLocale(),o=s.computed((()=>t.value?i("success"):e.value?i("something-went-wrong"):i("log-in-with-a-passkey")));return{showFailure:e,showSuccess:t,loading:n,pageLoading:a,title:o,uiSuccess:()=>{t.value=!0,e.value=!1,n.value=!1},uiError:()=>{t.value=!1,e.value=!0,n.value=!1},uiLoading:()=>{t.value=!1,e.value=!1,n.value=!0}}}(),{showFailure:r,showSuccess:c,loading:u,pageLoading:d,title:p}=o,f=(e=>{const t=s.ref(),n=s.ref(!1);return{magicLinkAction:t,invalidMagicLink:n,isMagicLinkValid:()=>{const a=new URLSearchParams(window.location.href.split("?")[1]);return a.has("psg_magic_link")?t.value="psg_magic_link":a.has("psg_verify_link")&&(t.value="psg_verify_link"),t.value&&e||(n.value=!0),!n.value}}})(t.magicLink),{isMagicLinkValid:v,invalidMagicLink:m,magicLinkAction:g}=f,h=ye({uiState:o,magicLinkUtils:f,passage:i,magicLink:t.magicLink});function y(){m.value?window.location.href=window.location.href.split("?")[0]:h.activateWithoutBiometrics(t.webauthnAllowed,g.value)}return s.onMounted((()=>l(this,null,(function*(){v()?(yield h.activateWithoutBiometrics(t.webauthnAllowed,g.value),L().onEvent.value(w.onMagicLinkActivateSuccess)):o.uiError(),d.value=!1})))),(e,t)=>(s.openBlock(),s.createBlock(s.Transition,{name:"fade",mode:"out-in",appear:""},{default:s.withCtx((()=>[s.withDirectives(s.createBaseVNode("div",ke,[s.createBaseVNode("div",{class:s.normalizeClass(["title has-text-centered",[s.unref(c)?"main-title":"secondary-title"]])},s.toDisplayString(s.unref(r)?s.unref(m)?s.unref(n)("invalid-link"):s.unref(n)("device-login-failed-title"):s.unref(p)),3),s.createBaseVNode("figure",Be,[s.unref(c)?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).success,alt:"Magic link success"},null,8,["src"])):s.unref(r)?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).failure,alt:"Magic link failure"},null,8,["src"])):s.createCommentVNode("",!0)]),s.createBaseVNode("div",be,[s.unref(c)&&s.unref(g)===s.unref(he).LOGIN?(s.openBlock(),s.createElementBlock("div",we,s.toDisplayString(s.unref(n)("successfully-logged-in-redirect")),1)):s.unref(c)&&s.unref(g)===s.unref(he).VERIFY?(s.openBlock(),s.createElementBlock("div",Ie,s.toDisplayString(s.unref(n)("successfully-changed-email")),1)):s.unref(r)&&s.unref(m)&&s.unref(g)===s.unref(he).VERIFY?(s.openBlock(),s.createElementBlock("div",Ce,s.toDisplayString(s.unref(n)("link-invalid")),1)):s.unref(r)&&s.unref(m)?(s.openBlock(),s.createElementBlock("div",Ve,s.toDisplayString(s.unref(n)("login-link-invalid")),1)):s.unref(r)&&s.unref(g)===s.unref(he).VERIFY?(s.openBlock(),s.createElementBlock("div",Ne,s.toDisplayString(s.unref(n)("verification-failed-please-try-again")),1)):s.createCommentVNode("",!0)]),s.unref(r)||s.unref(c)?(s.openBlock(),s.createElementBlock("div",xe,[s.createBaseVNode("button",{onClick:s.withModifiers(y,["prevent"]),type:"button",class:s.normalizeClass(["button is-primary",{"is-loading":s.unref(u)}]),part:"button",disabled:s.unref(u),"data-test":"activate-magic-link-button"},[s.unref(r)&&s.unref(m)?(s.openBlock(),s.createElementBlock("span",_e,s.toDisplayString(s.unref(n)("request-new-link")),1)):s.unref(r)?(s.openBlock(),s.createElementBlock("span",Ee,s.toDisplayString(s.unref(n)("try-again")),1)):s.unref(c)?(s.openBlock(),s.createElementBlock("span",De,s.toDisplayString(s.unref(n)("redirect-now")),1)):s.createCommentVNode("",!0)],10,Se)])):s.createCommentVNode("",!0)],512),[[s.vShow,!s.unref(d)]])])),_:1}))}}),Te={class:"view-verify-token"},Ae=s.defineComponent({__name:"ActivateMagicLinkView",props:{magicLink:{},webauthnAllowed:{type:Boolean}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Te,[s.createVNode(Le,{magicLink:e.magicLink,webauthnAllowed:e.webauthnAllowed},null,8,["magicLink","webauthnAllowed"])]))}),Me={class:"view-email-input"},Re=s.defineComponent({__name:"LoginView",props:{register:{type:Boolean},appInfo:{},conditionalUI:{type:Boolean},changeEmail:{type:Boolean}},setup(e){const t=s.ref(""),{defaultCountryCode:n}=s.useDefaultCountryCode(),a=n;return(e,n)=>(s.openBlock(),s.createElementBlock("div",Me,[s.createVNode(H,{identifier:t.value,"onUpdate:identifier":n[0]||(n[0]=e=>t.value=e),countryCode:s.unref(a),"onUpdate:countryCode":n[1]||(n[1]=e=>s.isRef(a)?a.value=e:null),canToggleLoginRegister:!1,appInfo:e.appInfo,conditionalUI:e.conditionalUI,changeEmail:e.changeEmail},{loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},8,["identifier","countryCode","appInfo","conditionalUI","changeEmail"]),s.createVNode(oe,{"app-info":e.appInfo},null,8,["app-info"])]))}}),Ue={class:"view-email-input"},Fe=s.defineComponent({__name:"RegisterView",props:{register:{type:Boolean},appInfo:{}},setup(e){const t=s.ref(""),{defaultCountryCode:n}=s.useDefaultCountryCode(),a=n;return(e,n)=>(s.openBlock(),s.createElementBlock("div",Ue,[s.createVNode(W,{identifier:t.value,"onUpdate:identifier":n[0]||(n[0]=e=>t.value=e),countryCode:s.unref(a),"onUpdate:countryCode":n[1]||(n[1]=e=>s.isRef(a)?a.value=e:null),canToggleLoginRegister:!1,appInfo:e.appInfo},null,8,["identifier","countryCode","appInfo"]),s.createVNode(oe,{"app-info":e.appInfo},null,8,["app-info"])]))}}),Pe=s.defineComponent({name:"Spinner"}),Oe={class:"spinner-box"},$e={class:"spinner-content"};var je=s._export_sfc(Pe,[["render",function(e,t,n,a,i,o){return s.openBlock(),s.createElementBlock("div",Oe,[s.createBaseVNode("div",$e,[s.renderSlot(e.$slots,"default")])])}]]);const He={class:"auth-flex-container"},ze={class:"title has-text-centered"},We={key:0,class:"content has-text-centered",style:{"margin-bottom":"15px !important"}},Ye=["innerHTML"],qe={class:"flex-row flex-center"},Ke=["onClick","disabled"],Ge=s.createBaseVNode("div",{class:"spacer"},null,-1),Ze={class:"link has-text-centered"},Je=["onClick"],Qe=s.defineComponent({__name:"MagicLink",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup(e){const t=e,{t:n,locale:a}=s.useLocale(),{appId:i}=s.useAppId(),o=new s.Y(i.value),{emitEvent:r}=j(),c=s.computed((()=>t.identifierType===u.email)),d=s.computed((()=>t.identifierVerifying?c.value?t.userIsRegistering?n("verify-email-to-register"):n("verify-email-to-login"):t.userIsRegistering?n("verify-phone-to-register"):n("verify-phone-to-login"):c.value?t.userIsRegistering?n("check-email-to-register"):n("check-email-to-login"):t.userIsRegistering?n("check-phone-to-register"):n("check-phone-to-login"))),p=s.computed((()=>{let e="";const a=t.identifierType===u.email?n("messagetype-email"):n("messagetype-sms"),i=t.identifierType===u.email?n("email"):n("phone-number"),o=t.userIsRegistering?n("registration"):n("login"),r=t.identifierVerifying?n("please-verify-identifier",[i,o]):n("you-will-be-automatically-signed-in");return e=n("weve-sent-messagetype",[a,t.identifier,r]),t.setupNewDevice&&!t.userIsRegistering&&(e=n("we-dont-recognize-this-device")+" "+e),e}));function f(){localStorage.removeItem("email"),localStorage.removeItem("magic_link_id"),localStorage.removeItem("wait_count"),b(721),r({type:R.ChangeIdentifier,payload:void 0})}function v(){return l(this,null,(function*(){yield h()}))}s.onMounted((()=>{t.userIsRegistering?function(){l(this,null,(function*(){m.value=!1,g.value=!0,yield new Promise((e=>{setTimeout(e,2e3)}));try{const e=yield o.newRegisterMagicLink(t.identifier,a.value.split("-")[0]);""!=e.id&&(localStorage.setItem("magic_link_id",e.id),b(0))}catch(e){console.log("magicLinkSend error",e)}finally{g.value=!1}}))}():h()}));const m=s.ref(!1),g=s.ref(!0);function h(){return l(this,null,(function*(){m.value=!1,g.value=!0;try{const e=yield o.newLoginMagicLink(t.identifier,a.value.split("-")[0]);""!=e.id&&(localStorage.setItem("magic_link_id",e.id),b(0))}catch(e){console.log("magicLinkSend error",e)}finally{yield new Promise((e=>{setTimeout(e,3e3)})),g.value=!1}}))}let y,k;function B(){return l(this,null,(function*(){const e=localStorage.getItem("magic_link_id");yield function(e){return l(this,null,(function*(){yield o.getMagicLinkStatus(e).then((e=>{b(721),y=e})).catch((()=>{}))}))}(e).then((()=>l(this,null,(function*(){y&&""!=y.redirect_url&&(localStorage.removeItem("magic_link_id"),localStorage.removeItem("wait_count"),L().onEvent.value(w.onMagicLinkActivated),r({type:R.FallbackAuthSuccess,payload:{identifier:t.identifier,authResult:y}}))}))))}))}function b(e){let t=e;if(!(t<720))return clearTimeout(k),void(m.value=!1);m.value=!0,k=setTimeout((()=>l(this,null,(function*(){!function(e){B(),localStorage.setItem("wait_count",e.toString())}(t),t++,b(t)}))),5e3)}return(e,t)=>(s.openBlock(),s.createElementBlock("div",He,[s.createBaseVNode("div",ze,[s.createBaseVNode("span",null,s.toDisplayString(d.value),1)]),s.createVNode(je,null,{default:s.withCtx((()=>[c.value?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).email,alt:"Email envelope"},null,8,["src"])):(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).phone,alt:"Message bubbles"},null,8,["src"]))])),_:1}),p.value?(s.openBlock(),s.createElementBlock("div",We,[s.createBaseVNode("span",{innerHTML:p.value},null,8,Ye)])):s.createCommentVNode("",!0),s.createBaseVNode("div",qe,[s.createBaseVNode("button",{onClick:s.withModifiers(v,["prevent"]),type:"button",class:"button is-primary",part:"button",disabled:g.value},s.toDisplayString(s.unref(n)("resend-isemail-email-message",[c.value?s.unref(n)("email"):s.unref(n)("message")])),9,Ke)]),Ge,s.createBaseVNode("div",Ze,[s.createBaseVNode("a",{onClick:s.withModifiers(f,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(n)("change-isemail-email-phone",[c.value?s.unref(n)("email"):s.unref(n)("phone")])),9,Je)])]))}}),Xe={class:"view-access-token"},et=s.defineComponent({__name:"MagicLinkView",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Xe,[s.createVNode(Qe,{identifier:e.identifier,userIsRegistering:e.userIsRegistering,identifierVerifying:e.identifierVerifying,setupNewDevice:e.setupNewDevice,identifierType:e.identifierType},null,8,["identifier","userIsRegistering","identifierVerifying","setupNewDevice","identifierType"])]))}),tt={class:"passage-learnmore-modal"},nt={class:"passage-learnmore-top"},at={class:"passage-learnmore-close-button"},it={class:"passage-learnmore-content"},ot={style:{"margin-bottom":"32px"}},rt=s.defineComponent({__name:"LearnMoreLayout",setup(e){const{t:t}=s.useLocale(),n=s.ref(!1);return(e,a)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[n.value?(s.openBlock(),s.createElementBlock("div",{key:0,class:"passage-learnmore",onClick:a[1]||(a[1]=e=>n.value=!1)},[s.createBaseVNode("div",tt,[s.createBaseVNode("div",nt,[s.createBaseVNode("div",{style:{cursor:"pointer"},onClick:a[0]||(a[0]=e=>n.value=!1)},[s.createBaseVNode("span",at,s.toDisplayString(s.unref(t)("close")),1),s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).close},null,8,["src"])])]),s.createBaseVNode("div",it,[s.renderSlot(e.$slots,"body")])])])):s.createCommentVNode("",!0),s.createBaseVNode("div",null,[s.createBaseVNode("div",ot,[s.createBaseVNode("span",null,[s.renderSlot(e.$slots,"cta"),s.createTextVNode("   ")]),s.createBaseVNode("a",{style:{"text-decoration":"underline"},onClick:a[2]||(a[2]=e=>n.value=!0),role:"button"},s.toDisplayString(s.unref(t)("learn-more")),1),s.createTextVNode(" → ")])])],64))}}),lt={style:{"margin-bottom":"12px"}},st={class:"passage-learnmore-header"},ct={class:"passage-learnmore-body"},ut={class:"passage-learnmore-header"},dt={class:"passage-learnmore-body"},pt={class:"passage-learnmore-header"},ft={class:"passage-learnmore-body"},vt=s.defineComponent({__name:"LearnMorePasskey",props:{cta:{}},setup(e){const{t:t}=s.useLocale();return(e,n)=>(s.openBlock(),s.createBlock(rt,null,{cta:s.withCtx((()=>[s.createBaseVNode("div",lt,s.toDisplayString(s.unref(t)("passkeys-are-a-simple")),1),s.createTextVNode(" "+s.toDisplayString(e.cta),1)])),body:s.withCtx((()=>[s.createBaseVNode("div",st,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).privateIcon,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("private")),1)]),s.createBaseVNode("div",ct,s.toDisplayString(s.unref(t)("unlock-your-passkey")),1),s.createBaseVNode("div",ut,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).secure,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("secure")),1)]),s.createBaseVNode("div",dt,s.toDisplayString(s.unref(t)("passkey-is-unique")),1),s.createBaseVNode("div",pt,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).simple,style:{"margin-right":"8px"}},null,8,["src"]),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("simple")),1)]),s.createBaseVNode("div",ft,s.toDisplayString(s.unref(t)("easy-to-use")),1)])),_:1}))}}),mt={class:"auth-flex-container","data-tag":"register-device-message"},gt={class:"title secondary-title has-text-centered"},ht={class:"image has-text-centered"},yt={key:0},kt={key:2,class:"flex-row flex-center"},Bt=["onClick","disabled"],bt=["onClick","disabled"],wt={key:3,class:"flex-row flex-center"},It=["onClick","disabled"],Ct=s.createBaseVNode("div",{class:"spacer"},null,-1),Vt={key:4,class:"content has-text-centered",style:{"margin-top":"20px !important"}},Nt={class:"link"},xt=["onClick"],St={class:"link"},_t=["onClick"],Et={key:0,class:"link"},Dt=["onClick"],Lt=s.defineComponent({__name:"RegisterDevice",props:{identifier:{},identifierType:{},appInfo:{}},setup(e){const t=e,n=s.ref(!1),a=s.ref(!1),{t:i,te:o}=s.useLocale(),{appId:r}=s.useAppId(),c=new s.Y(r.value),{emitEvent:p}=j(),{autofocusButton:f}=d(),v=s.computed((()=>t.identifierType===u.email)),m=s.computed((()=>{var e;return null!=(e=t.appInfo.auth_fallback_method)?e:s.ue.MagicLink})),g=s.computed((()=>t.appInfo.auth_fallback_method!==s.ue.None)),h=s.computed((()=>m.value===s.ue.LoginCode?o("register-with-code")?i("register-with-code"):"Register with a code":i("register-with-link",[v.value?i("email"):i("sms-text")]))),y=s.computed((()=>m.value===s.ue.LoginCode?o("send-code")?i("send-code"):"Send code":i("send-email-or-text-link",[v.value?i("email"):i("sms-text")]))),k=s.computed((()=>{switch(t.appInfo.auth_fallback_method){case s.ue.LoginCode:return o("passkey-create-fail-try-code")?i("passkey-create-fail-try-code"):"Unable to create a passkey. Try again or register with a one-time code.";case s.ue.MagicLink:return i("passkey-create-fail-try-link");case s.ue.None:return i("passkey-create-fail-no-fallback")}}));function B(){p({type:R.FallbackAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userIsRegistering:!0,userInitiated:!0}})}function b(){localStorage.removeItem("email"),j().emitEvent({type:R.ChangeIdentifier,payload:void 0})}function w(){!function(e){l(this,null,(function*(){a.value=!0,n.value=!1;try{const n=yield c.register(e);a.value=!1,p({type:R.AuthSuccess,payload:{authResult:n,identifier:t.identifier}})}catch(i){n.value=!0,a.value=!1}}))}(t.identifier)}return(e,t)=>(s.openBlock(),s.createElementBlock("div",mt,[s.createBaseVNode("div",gt,s.toDisplayString(s.unref(i)("register-with-a-passkey")),1),s.createBaseVNode("figure",ht,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkey,alt:"Register with a passkey",style:{margin:"5px"}},null,8,["src"])]),n.value?(s.openBlock(),s.createElementBlock("div",yt,[s.createBaseVNode("p",null,s.toDisplayString(k.value),1)])):(s.openBlock(),s.createBlock(vt,{key:1,cta:s.unref(i)("register-your-account")},null,8,["cta"])),n.value?(s.openBlock(),s.createElementBlock("div",kt,[s.createBaseVNode("button",{onClick:s.withModifiers(w,["prevent"]),type:"button",part:"button",class:"button is-primary",disabled:a.value,style:{"margin-right":"5px"}},s.toDisplayString(s.unref(i)("try-again")),9,Bt),e.appInfo.auth_fallback_method!==s.unref(s.ue).None?(s.openBlock(),s.createElementBlock("button",{key:0,onClick:s.withModifiers(B,["prevent"]),type:"button",part:"button button-secondary",class:"button is-secondary",disabled:a.value,style:{"margin-left":"5px"},"data-test":"login-with-email-button",ref_key:"autofocusButton",ref:f},s.toDisplayString(y.value),9,bt)):s.createCommentVNode("",!0)])):(s.openBlock(),s.createElementBlock("div",wt,[s.createBaseVNode("button",{onClick:s.withModifiers(w,["prevent"]),type:"button",class:s.normalizeClass(["button",[{"is-loading":a.value}]]),part:"button",disabled:a.value,"data-test":"register-main-button",tabindex:"0",ref_key:"autofocusButton",ref:f},[s.createBaseVNode("span",null,s.toDisplayString(s.unref(i)("register-with-passkey")),1)],10,It)])),Ct,n.value?(s.openBlock(),s.createElementBlock("div",Vt,[s.createBaseVNode("div",Nt,[s.createBaseVNode("a",{onClick:s.withModifiers(b,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(i)("change-isemail-email-phone",[v.value?s.unref(i)("email"):s.unref(i)("phone")])),9,xt)])])):s.createCommentVNode("",!0),n.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",{key:5,class:s.normalizeClass(["flex-row flex-wrap",g.value?"flex-between":"flex-center"])},[s.createBaseVNode("div",St,[s.createBaseVNode("a",{onClick:s.withModifiers(b,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(i)("back")),9,_t)]),g.value?(s.openBlock(),s.createElementBlock("div",Et,[s.createBaseVNode("a",{onClick:s.withModifiers(B,["prevent"]),role:"button","data-test":"register-email-button"},s.toDisplayString(h.value),9,Dt)])):s.createCommentVNode("",!0)],2))]))}}),Tt=s.defineComponent({__name:"RegisterDeviceView",props:{identifier:{},identifierType:{},appInfo:{}},setup:e=>(e,t)=>(s.openBlock(),s.createBlock(Lt,{identifier:e.identifier,identifierType:e.identifierType,appInfo:e.appInfo},null,8,["identifier","identifierType","appInfo"]))}),At={class:"auth-flex-container"},Mt={class:"title has-text-centered"},Rt={class:"image has-text-centered",style:{margin:"5px auto"}},Ut={key:1,class:"wrap-text",style:{"margin-bottom":"5px !important"}},Ft={"data-test":"failure-message"},Pt={key:2,class:"flex-row flex-center"},Ot=["onClick","disabled"],$t=["onClick","disabled"],jt=s.createBaseVNode("div",{class:"spacer"},null,-1),Ht={key:3,class:"content has-text-centered",style:{"margin-top":"20px !important"}},zt={class:"link"},Wt=["onClick"],Yt={class:"link"},qt=["onClick"],Kt={key:0,class:"link"},Gt=["onClick"],Zt=s.defineComponent({__name:"WebauthnSignIn",props:{identifier:{},identifierType:{},appInfo:{}},setup(e){const t=e,n=s.ref(!1),a=s.ref(!1),{t:i,te:o}=s.useLocale(),{appId:r}=s.useAppId(),c=new s.Y(r.value),{emitEvent:p}=j(),f=s.computed((()=>t.identifierType===u.email)),{autofocusButton:v}=d(),m=s.computed((()=>{var e;return null!=(e=t.appInfo.auth_fallback_method)?e:s.ue.MagicLink})),g=s.computed((()=>t.appInfo.auth_fallback_method!==s.ue.None)),h=s.computed((()=>m.value===s.ue.LoginCode?o("send-code")?i("send-code"):"Send code":i("send-email-or-text-link",[f.value?i("email"):i("sms-text")]))),y=s.computed((()=>m.value===s.ue.LoginCode?o("login-with-code")?i("login-with-code"):"Login with a code":i("login-with-link",[f.value?i("email"):i("sms-text")]))),k=s.computed((()=>{switch(t.appInfo.auth_fallback_method){case s.ue.LoginCode:return o("passkey-login-fail-try-code")?i("passkey-login-fail-try-code"):"Unable to log in with a passkey. Try again or log in with a one-time code.";case s.ue.MagicLink:return i("passkey-login-fail-try-link");case s.ue.None:return i("passkey-login-fail-no-fallback")}}));function B(){return l(this,null,(function*(){if(n.value=!1,t.identifier){a.value=!0;try{const e=yield c.login(t.identifier);p({type:R.AuthSuccess,payload:{authResult:e,identifier:t.identifier}}),a.value=!1}catch(e){const i=e;n.value=!0,a.value=!1,i.statusCode===s.T.PSGParsePublicKeyForLoginFailed?n.value=!0:p({type:R.FallbackAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userInitiated:!1}})}}}))}function b(){p({type:R.FallbackAuth,payload:{identifier:t.identifier,identifierType:t.identifierType,userInitiated:!0}})}function w(){localStorage.removeItem("email"),p({type:R.ChangeIdentifier,payload:void 0})}return s.onMounted((()=>{B()})),(e,t)=>(s.openBlock(),s.createElementBlock("div",At,[s.createBaseVNode("div",Mt,s.toDisplayString(s.unref(i)("log-in-with-a-passkey")),1),s.createBaseVNode("figure",Rt,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkey,alt:"Log in with a passkey",style:{margin:"5px"}},null,8,["src"])]),n.value?n.value?(s.openBlock(),s.createElementBlock("div",Ut,[s.createBaseVNode("div",Ft,[s.createBaseVNode("p",null,s.toDisplayString(k.value),1)])])):s.createCommentVNode("",!0):(s.openBlock(),s.createBlock(vt,{key:0,cta:s.unref(i)("log-into-your-account")},null,8,["cta"])),n.value?(s.openBlock(),s.createElementBlock("div",Pt,[s.createBaseVNode("button",{onClick:s.withModifiers(B,["prevent"]),type:"button",part:"button",class:"button is-primary",disabled:a.value,style:{"margin-right":"5px"}},s.toDisplayString(s.unref(i)("try-again")),9,Ot),e.appInfo.auth_fallback_method!==s.unref(s.ue).None?(s.openBlock(),s.createElementBlock("button",{key:0,onClick:s.withModifiers(b,["prevent"]),type:"button",part:"button button-secondary",class:"button is-secondary",disabled:a.value,style:{"margin-left":"5px"},"data-test":"login-with-email-button",ref_key:"autofocusButton",ref:v},s.toDisplayString(h.value),9,$t)):s.createCommentVNode("",!0)])):s.createCommentVNode("",!0),jt,n.value?(s.openBlock(),s.createElementBlock("div",Ht,[s.createBaseVNode("div",zt,[s.createBaseVNode("a",{onClick:s.withModifiers(w,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(i)("change-isemail-email-phone",[f.value?s.unref(i)("email"):s.unref(i)("phone")])),9,Wt)])])):s.createCommentVNode("",!0),n.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",{key:4,class:s.normalizeClass(["flex-row flex-wrap",g.value?"flex-between":"flex-center"])},[s.createBaseVNode("div",Yt,[s.createBaseVNode("a",{onClick:s.withModifiers(w,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(i)("back")),9,qt)]),g.value?(s.openBlock(),s.createElementBlock("div",Kt,[s.createBaseVNode("a",{onClick:s.withModifiers(b,["prevent"]),role:"button","data-test":"register-email-button"},s.toDisplayString(y.value),9,Gt)])):s.createCommentVNode("",!0)],2))]))}}),Jt={class:"view-webauthn-sign-in"},Qt=s.defineComponent({__name:"WebauthnSignInView",props:{identifier:{},identifierType:{},appInfo:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Jt,[s.createVNode(Zt,{identifier:e.identifier,identifierType:e.identifierType,appInfo:e.appInfo},null,8,["identifier","identifierType","appInfo"])]))}),Xt={style:{display:"flex","align-items":"center"},class:"psg-otp-single-input-container"},en=["data-test","type","inputtype","placeholder","inputmode","disabled","maxlength","autocomplete"],tn={key:0},nn=["innerHTML"],an=s.defineComponent({__name:"OneTimePasscodeSingleInput",props:{conditionalClass:{},focus:{type:Boolean},inputClasses:{default:()=>[]},inputmode:{default:"numeric"},inputType:{default:"number"},isDisabled:{type:Boolean},isLastChild:{type:Boolean},placeholder:{},separator:{default:""},shouldAutoFocus:{type:Boolean,default:!1},value:{default:""},isFirstChild:{type:Boolean},inputIdx:{},inputCount:{}},emits:["on-change","on-keydown","on-paste","on-focus","on-blur"],setup(e,{emit:t}){const n=e,a=s.ref(n.value||""),i=s.ref(null),o=s.computed((()=>"letter-numeric"===n.inputType?"text":n.inputType)),r=()=>(a.value=a.value.toString(),a.value.length>1&&(a.value=a.value.slice(0,1)),t("on-change",a.value)),l=e=>{n.isDisabled&&e.preventDefault();const a=e||window.event,i=a.which?a.which:a.keyCode;(e=>e>=48&&e<=57||e>=96&&e<=105)(i)||"letter-numeric"===n.inputType&&(e=>e>=65&&e<=90)(i)||[8,9,13,37,39,46,86].includes(i)?t("on-keydown",e):a.preventDefault()},c=e=>t("on-paste",e),u=()=>(i.value.select(),t("on-focus")),d=()=>t("on-blur");return s.watch((()=>n.value),((e,t)=>{e!==t&&(a.value=e)})),s.watch((()=>n.focus),((e,t)=>{t!==e&&i.value&&n.focus&&(i.value.focus(),i.value.select())})),s.onMounted((()=>{i.value&&n.focus&&n.shouldAutoFocus&&(i.value.focus(),i.value.select())})),(e,t)=>(s.openBlock(),s.createElementBlock("div",Xt,[s.withDirectives(s.createBaseVNode("input",{"data-test":`single-input-${e.inputIdx}`,type:o.value,inputtype:o.value,placeholder:e.placeholder,inputmode:e.inputmode,disabled:e.isDisabled,ref_key:"input",ref:i,pattern:"[0-9]*",maxlength:e.isFirstChild?e.inputCount:1,min:"0",max:"9","onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),class:s.normalizeClass(["psg-input","psg-otp-input",[...e.inputClasses||[]]]),onInput:r,onKeydown:l,onPaste:c,onFocus:u,onBlur:d,autocomplete:e.isFirstChild?"one-time-code":"off"},null,42,en),[[s.vModelDynamic,a.value]]),!e.isLastChild&&e.separator?(s.openBlock(),s.createElementBlock("span",tn,[s.createBaseVNode("span",{innerHTML:e.separator},null,8,nn)])):s.createCommentVNode("",!0)]))}}),on={style:{display:"flex","justify-content":"space-between"},class:"psg-otp-input-container"},rn={key:0,autocomplete:"off",name:"hidden",type:"text",style:{display:"none"}},ln=s.defineComponent({__name:"OneTimePasscodeInput",props:{value:{default:""},numInputs:{default:6},separator:{default:""},inputClasses:{},conditionalClass:{default:()=>[]},inputType:{default:"number"},inputmode:{default:"numeric"},shouldAutoFocus:{type:Boolean,default:!1},placeholder:{default:()=>[]},isDisabled:{type:Boolean,default:!1},disableNonCurrent:{type:Boolean,default:!1}},emits:["update:value","on-complete","on-change"],setup(e,{emit:t}){const n=e,a=s.ref(0),i=s.ref([]),o=s.ref([]);s.watch((()=>n.value),(e=>{const t=(s.unref(e)||"").padEnd(n.numInputs," ").split("");i.value=t}),{immediate:!0});const r=()=>{a.value=-1},l=e=>{a.value=Math.max(Math.min(n.numInputs-1,e),0)},c=()=>{n.disableNonCurrent?setTimeout((()=>{l(a.value+1)}),200):l(a.value+1)},u=()=>{l(a.value-1)},d=e=>{o.value=Object.assign([],i.value),i.value[a.value]=e,o.value.join("")!==i.value.join("")&&(t("update:value",i.value.join("")),t("on-change",i.value.join("")))},p=e=>{var o;e.preventDefault();const r=null==(o=e.clipboardData)?void 0:o.getData("text/plain").slice(0,n.numInputs-a.value).split("");if("number"===n.inputType&&!(null==r?void 0:r.join("").match(/^\d+$/)))return"Invalid pasted data";if("letter-numeric"===n.inputType&&!(null==r?void 0:r.join("").match(/^\w+$/)))return"Invalid pasted data";const s=i.value.slice(0,a.value).concat(r||"");return s.slice(0,n.numInputs).forEach(((e,t)=>{i.value[t]=e})),l(s.slice(0,n.numInputs).length),i.value.join("").length===n.numInputs?(t("update:value",i.value.join("")),t("on-complete",i.value.join(""))):"Wait until the user enters the required number of characters"},f=e=>{d(e),c()},v=e=>{switch(e.keyCode){case 8:e.preventDefault(),d(""),u();break;case 46:e.preventDefault(),d("");break;case 37:e.preventDefault(),u();break;case 39:e.preventDefault(),c()}};return(e,t)=>(s.openBlock(),s.createElementBlock("div",on,["password"===e.inputType?(s.openBlock(),s.createElementBlock("input",rn)):s.createCommentVNode("",!0),(s.openBlock(!0),s.createElementBlock(s.Fragment,null,s.renderList(e.numInputs,((t,n)=>(s.openBlock(),s.createBlock(an,{key:n,focus:a.value===n,value:i.value[n],separator:e.separator,"input-type":e.inputType,inputmode:e.inputmode,"input-classes":e.inputClasses,conditionalClass:e.conditionalClass[n],"is-last-child":n===e.numInputs-1,"is-first-child":0===n,"should-auto-focus":e.shouldAutoFocus,placeholder:e.placeholder[n],"is-disabled":e.isDisabled||e.disableNonCurrent&&n>i.value.join("").trim().length,"input-idx":n,"input-count":e.numInputs,onOnChange:f,onOnKeydown:v,onOnPaste:p,onOnFocus:e=>{return t=n,void(a.value=t);var t},onOnBlur:r},null,8,["focus","value","separator","input-type","inputmode","input-classes","conditionalClass","is-last-child","is-first-child","should-auto-focus","placeholder","is-disabled","input-idx","input-count","onOnFocus"])))),128))]))}}),sn={class:"auth-flex-container"},cn={class:"title has-text-centered"},un={class:"content wrap-text"},dn={style:{"margin-top":"32px","margin-bottom":"40px"}},pn=["innerHTML"],fn={class:"flex flex-row flex-center"},vn={class:"flex-row",style:{"margin-top":"8px"}},mn={class:"error-message",style:{"min-height":"17px"}},gn={class:"flex-row flex-center",style:{"margin-top":"16px"}},hn=["onClick","disabled"],yn=s.createBaseVNode("div",{class:"spacer"},null,-1),kn={class:"flex-row flex-wrap flex-between"},Bn={class:"link"},bn=["onClick"],wn={class:"link"},In=["onClick"],Cn=s.defineComponent({__name:"OneTimePasscode",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup(e){const t=e,{t:n,te:a,locale:i}=s.useLocale(),{appId:o}=s.useAppId(),r=s.ref(!0),c=s.ref(void 0),u=s.ref(!1),d=s.ref(!1),p=s.ref(void 0),f=s.ref(void 0),v=s.computed((()=>a("enter-code")?n("enter-code",{}):"Enter code")),m=s.computed((()=>a("enter-code-sent")?n("enter-code-sent",[t.identifier]):`A one-time code has been sent to <span style="font-weight: 700;">${t.identifier}</span>. Enter the code here to log in.`)),g=s.computed((()=>a("back")?n("back"):"Back")),h=s.computed((()=>a("resend-code")?n("resend-code"):"Resend code")),y=s.computed((()=>u.value?["has-error"]:[])),k=s.computed((()=>false)),B=s.computed((()=>r.value));s.watch(c,(()=>{var e;_(),6===(null==(e=c.value)?void 0:e.trim().length)&&C()}));const b=new s.Y(o.value),I=(e=!1)=>l(this,null,(function*(){S(),_(),E(),r.value=!0;try{const n=e?yield b.newRegisterOneTimePasscode(t.identifier,i.value.split("-")[0]):yield b.newLoginOneTimePasscode(t.identifier,i.value.split("-")[0]);""!=n.otp_id&&(localStorage.setItem("otp_id",n.otp_id),f.value=n.otp_id)}catch(o){D(a("code-send-error")?n("code-send-error"):"An error occurred sending the code.",!0)}finally{r.value=!1}})),C=()=>l(this,null,(function*(){S(),_(),r.value=!0;try{if(!c.value)throw new Error("Login code is undefined.");if(6!==c.value.length)throw new Error("Login code is invalid length.");if(!f.value)throw new Error("Login code id is undefined.");const e=yield b.oneTimePasscodeActivate(c.value,f.value);e&&""!=e.redirect_url&&(localStorage.removeItem("otp_id"),L().onEvent.value(w.onOneTimePasscodeActivated),j().emitEvent({type:R.FallbackAuthSuccess,payload:{identifier:t.identifier,authResult:e}}))}catch(e){D(a("code-invalid-or-expired")?n("code-invalid-or-expired"):"Code is invalid or expired. Please try again.")}finally{r.value=!1}})),V=()=>{j().emitEvent({type:R.ChangeIdentifier,payload:void 0})},N=()=>{I()},x=()=>{C()};s.onMounted((()=>{I(t.userIsRegistering),function(){const e=T.value.getRootNode().host;T.value.appendChild(function(){const e=document.createElement("style");return e.appendChild(document.createTextNode("\n      .psg-otp-input-container{\n        margin: 0px;\n        padding: 0px;\n        align-items: center;\n        height: auto;\n        width: auto;\n      }\n      .psg-otp-single-input-container{\n        margin: 0px;\n        padding: 0px;\n        height: auto;\n        width: auto;\n      }\n      .psg-otp-input {\n        width: 40px;\n        height: 40px;\n        padding: 0px;\n        margin-left: 4px;\n        margin-right: 4px;\n        font-size: 24px;\n        font-weight: 400;\n        line-height: 29px;\n        border-radius: 4px;\n        border: 1px solid transparent;\n        text-align: center;\n        background-color: var(--passage-otp-input-background-color, #d7d7d7);\n        -moz-appearance: textfield;\n      }\n      .psg-otp-input:read-only {\n        background-color: var(--passage-otp-input-background-color, #d7d7d7);\n      }\n      .psg-otp-input::-webkit-inner-spin-button{\n        -webkit-appearance: none;\n        display: none;\n        margin: 0;\n      }\n      .psg-otp-input::-webkit-outer-spin-button{\n        -webkit-appearance: none;\n        display: none;\n        margin: 0;\n      }\n      .psg-input.has-error{\n        border-color: var(--passage-error-color, #dd0031) !important;\n      }\n      .psg-input.is-danger {\n        border-color: var(--passage-error-color, #dd0031) !important;\n      }\n      .psg-input:focus {\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-body-text-color, #000000);\n      }\n      .psg-input:active {\n        outline: none;\n        box-shadow: none !important;\n        border-color: var(--passage-body-text-color, #000000);\n      }")),e}()),e.appendChild(T.value)}()})),s.onBeforeUnmount((()=>{T.value.remove()}));const S=()=>{r.value=!0},_=()=>{p.value=void 0,u.value=!1,d.value=!1},E=()=>{c.value=void 0},D=(e,t=!1)=>{p.value=e,u.value=!t,d.value=t},T=s.ref();return(e,t)=>(s.openBlock(),s.createElementBlock("div",sn,[s.createBaseVNode("form",null,[s.createBaseVNode("div",cn,[s.createBaseVNode("span",null,s.toDisplayString(v.value),1)]),s.createBaseVNode("div",un,[s.createBaseVNode("div",dn,[s.createBaseVNode("p",{innerHTML:m.value},null,8,pn)])]),s.createBaseVNode("div",fn,[s.createBaseVNode("div",{ref_key:"otpInput",ref:T,slot:"otpInput"},[s.createVNode(ln,{"num-inputs":6,"is-disabled":k.value,value:c.value,"onUpdate:value":t[0]||(t[0]=e=>c.value=e),"input-classes":y.value,"disable-non-current":!1},null,8,["is-disabled","value","input-classes"])],512),s.renderSlot(e.$slots,"otpInput")]),s.createBaseVNode("div",vn,[s.createBaseVNode("div",mn,s.toDisplayString(p.value?p.value:" "),1)]),s.createBaseVNode("div",gn,[s.createBaseVNode("button",{type:"submit",class:"button is-primary",part:"button","data-test":"continue-button",onClick:s.withModifiers(x,["prevent"]),disabled:B.value},s.toDisplayString(s.unref(n)("continue")),9,hn)]),yn,s.createBaseVNode("div",kn,[s.createBaseVNode("div",Bn,[s.createBaseVNode("a",{onClick:s.withModifiers(V,["prevent"]),role:"button","data-test":"one-time-passcode-goback-button"},s.toDisplayString(g.value),9,bn)]),s.createBaseVNode("div",wn,[s.createBaseVNode("a",{onClick:s.withModifiers(N,["prevent"]),role:"button","data-test":"one-time-passcode-resend-button"},s.toDisplayString(h.value),9,In)])])])]))}}),Vn={class:"view-access-token"},Nn=s.defineComponent({__name:"OneTimePasscodeView",props:{identifier:{},userIsRegistering:{type:Boolean},identifierVerifying:{type:Boolean},setupNewDevice:{type:Boolean},identifierType:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Vn,[s.createVNode(Cn,{identifier:e.identifier,userIsRegistering:e.userIsRegistering,identifierVerifying:e.identifierVerifying,setupNewDevice:e.setupNewDevice,identifierType:e.identifierType},{otpInput:s.withCtx((()=>[s.renderSlot(e.$slots,"otpInput")])),_:3},8,["identifier","userIsRegistering","identifierVerifying","setupNewDevice","identifierType"])]))}),xn={class:"image has-text-centered"},Sn={key:0},_n={class:"flex-row flex-center",style:{padding:"20px 0px"}},En=["onClick","disabled"],Dn={key:0},Ln={key:1},Tn={key:2,class:"link has-text-centered"},An=["onClick"],Mn=s.defineComponent({__name:"AddDevice",props:{authResult:{},identifier:{}},setup(e){const t=e,{t:n}=s.useLocale(),{appId:a}=s.useAppId(),i=s.ref(!1),o=s.ref(!1),r=s.ref(),{addDevice:c,addPending:u}=s.useAddDevice(a.value),{autofocusButton:p}=d(),f=s.computed((()=>i.value?n("something-went-wrong"):n("add-passkey")));function v(){return l(this,null,(function*(){var e;r.value=yield c(),(null==(e=r.value)?void 0:e.id)?(o.value=!0,i.value=!1,m()):(i.value=!0,o.value=!1)}))}const m=()=>{j().emitEvent({type:R.AuthSuccess,payload:{identifier:t.identifier,authResult:t.authResult}})};return(e,t)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[s.createBaseVNode("div",{class:s.normalizeClass(["title has-text-centered",[i.value?"secondary-title":"main-title"]]),"data-test":"activate-magic-link-message"},s.toDisplayString(f.value),3),s.createBaseVNode("figure",xn,[i.value?(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:0,src:s.unref(s.Icons).fingerprintFailed,alt:"Device failure"},null,8,["src"])):(s.openBlock(),s.createBlock(s.unref(s.InlineSvg),{key:1,src:s.unref(s.Icons).passkey,alt:"Add a passkey",style:{margin:"5px"}},null,8,["src"]))]),i.value?(s.openBlock(),s.createElementBlock("div",Sn,s.toDisplayString(s.unref(n)("failed-to-add-this-device")),1)):(s.openBlock(),s.createBlock(vt,{key:1,cta:s.unref(n)("log-into-your-account")},null,8,["cta"])),s.createBaseVNode("div",_n,[s.createBaseVNode("button",{onClick:s.withModifiers(v,["prevent"]),type:"button",class:s.normalizeClass(["button is-primary",{"is-loading":s.unref(u)}]),part:"button",disabled:s.unref(u),"data-test":"save-device-button",ref_key:"autofocusButton",ref:p},[i.value?(s.openBlock(),s.createElementBlock("span",Dn,s.toDisplayString(s.unref(n)("try-again")),1)):(s.openBlock(),s.createElementBlock("span",Ln,s.toDisplayString(s.unref(n)("add-passkey")),1))],10,En)]),o.value?s.createCommentVNode("",!0):(s.openBlock(),s.createElementBlock("div",Tn,[s.createBaseVNode("div",null,[s.createBaseVNode("a",{onClick:s.withModifiers(m,["prevent"]),role:"button","data-test":"add-device-skip"},s.toDisplayString(s.unref(n)("skip")),9,An)])]))],64))}}),Rn={class:"view-add-device"},Un=s.defineComponent({__name:"AddDeviceView",props:{authResult:{},identifier:{}},setup:e=>(e,t)=>(s.openBlock(),s.createElementBlock("div",Rn,[s.createVNode(Mn,{authResult:e.authResult,identifier:e.identifier},null,8,["authResult","identifier"])]))}),Fn={class:"wrap-text",style:{"margin-bottom":"12px !important"}},Pn={class:"passage-learnmore-header"},On={class:"passage-learnmore-body"},$n={class:"passage-learnmore-header"},jn={class:"passage-learnmore-body"},Hn=s.defineComponent({__name:"LearnMoreDisabledFallbacks",setup(e){const{t:t}=s.useLocale();return(e,n)=>(s.openBlock(),s.createBlock(rt,null,{cta:s.withCtx((()=>[s.createBaseVNode("div",Fn,s.toDisplayString(s.unref(t)("passkeys-are-required"))+s.toDisplayString(" "),1),s.createTextVNode(" "+s.toDisplayString(s.unref(t)("try-again-on-device-with-passkeys")),1)])),body:s.withCtx((()=>[s.createBaseVNode("div",Pn,s.toDisplayString(s.unref(t)("what-are-passkeys")),1),s.createBaseVNode("div",On,s.toDisplayString(s.unref(t)("passkeys-are-a-simpler-and-more-secure-alternative")),1),s.createBaseVNode("div",$n,s.toDisplayString(s.unref(t)("devices-that-support-passkeys")),1),s.createBaseVNode("div",jn,s.toDisplayString(s.unref(t)("devices-with-a-biometric-sensor-are-likely-to-support-passkeys")),1)])),_:1}))}}),zn={class:"auth-flex-container"},Wn={class:"title has-text-centered"},Yn={class:"image has-text-centered",style:{margin:"5px auto"}},qn=s.createBaseVNode("div",{class:"spacer"},null,-1),Kn={class:"flex-row flex-wrap flex-center"},Gn={class:"link"},Zn=["onClick"],Jn=s.defineComponent({__name:"DisableFallbacks",setup(e){const{t:t}=s.useLocale(),{emitEvent:n}=j();function a(){localStorage.removeItem("email"),n({type:R.ChangeIdentifier,payload:void 0})}return(e,n)=>(s.openBlock(),s.createElementBlock("div",zn,[s.createBaseVNode("div",Wn,s.toDisplayString(s.unref(t)("device-not-supported")),1),s.createBaseVNode("figure",Yn,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkeyArrow,alt:"Device not supported",style:{margin:"5px"}},null,8,["src"])]),s.createVNode(Hn),qn,s.createBaseVNode("div",Kn,[s.createBaseVNode("div",Gn,[s.createBaseVNode("a",{onClick:s.withModifiers(a,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(t)("back")),9,Zn)])])]))}}),Qn=s.defineComponent({__name:"DisableFallbackView",setup:e=>(e,t)=>(s.openBlock(),s.createBlock(Jn))}),Xn={class:"auth-flex-container"},ea={class:"title has-text-centered"},ta={class:"image has-text-centered",style:{margin:"5px auto"}},na={class:"wrap-text",style:{"margin-bottom":"12px !important"}},aa={class:"wrap-text"},ia=s.createBaseVNode("div",{class:"spacer"},null,-1),oa={class:"flex-row flex-wrap flex-center"},ra={class:"link"},la=["onClick"],sa=s.defineComponent({__name:"LoginNotSupported",setup(e){const{t:t}=s.useLocale(),{emitEvent:n}=j();function a(){localStorage.removeItem("email"),n({type:R.ChangeIdentifier,payload:void 0})}return(e,n)=>(s.openBlock(),s.createElementBlock("div",Xn,[s.createBaseVNode("div",ea,s.toDisplayString(s.unref(t)("login-not-supported")),1),s.createBaseVNode("figure",ta,[s.createVNode(s.unref(s.InlineSvg),{src:s.unref(s.Icons).passkeyArrow,alt:"Device not supported",style:{margin:"5px"}},null,8,["src"])]),s.createBaseVNode("div",na,s.toDisplayString(s.unref(t)("passkeys-are-now-required")),1),s.createBaseVNode("div",aa,s.toDisplayString(s.unref(t)("please-contact-support-to-regain-access")),1),ia,s.createBaseVNode("div",oa,[s.createBaseVNode("div",ra,[s.createBaseVNode("a",{onClick:s.withModifiers(a,["prevent"]),role:"button","data-test":"change-email-button"},s.toDisplayString(s.unref(t)("back")),9,la)])])]))}}),ca=s.defineComponent({__name:"LoginNotSupportedView",setup:e=>(e,t)=>(s.openBlock(),s.createBlock(sa))}),ua={component:ge},da={component:Re},pa={component:Fe},fa={component:Tt},va={component:et},ma={component:Qt},ga={component:Ae},ha={component:Nn},ya={component:Un},ka={component:Qn},Ba={component:ca};class ba{constructor(e){this._homeRoute=ua,this._history=[],void 0!==e&&(this._homeRoute=e)}get homeRoute(){return this._homeRoute}set homeRoute(e){this._homeRoute=e}get currentRoute(){if(0!==this._history.length)return this._history[this._history.length-1]}push(e,l){var s;this._history.push((s=((e,t)=>{for(var n in t||(t={}))i.call(t,n)&&r(e,n,t[n]);if(a)for(var n of a(t))o.call(t,n)&&r(e,n,t[n]);return e})({},e),t(s,n({props:l}))))}resetRouter(){this._history=[]}}const wa={key:0,class:"notification is-danger has-text-centered","data-test":"invalid-app-id"},Ia=s.defineComponent({__name:"SmartRouter",props:{homeRoute:{}},setup(e){const t=e,n=s.reactive(new ba(t.homeRoute)),a=s.computed((()=>n.currentRoute)),{t:i}=s.useLocale(),{appInfo:o,loading:r,invalidAppId:c}=s.useAppInfo(),{initEventHandler:u}=j(),d=s.computed((()=>{var e;return null==(e=a.value)?void 0:e.component})),p=s.computed((()=>{var e;const t=null==(e=a.value)?void 0:e.props;return void 0===t?{}:t})),f=s.ref(!1);return s.watch(o,(()=>l(this,null,(function*(){f.value=!1,void 0!==o.value&&(yield u(o.value,n),f.value=!0)})))),(e,t)=>(s.openBlock(),s.createElementBlock(s.Fragment,null,[s.createVNode(s.Transition,{name:"fade",mode:"out-in",appear:""},{default:s.withCtx((()=>[!s.unref(r)&&f.value?(s.openBlock(),s.createBlock(s.resolveDynamicComponent(d.value),s.normalizeProps(s.mergeProps({key:0},p.value)),{otpInput:s.withCtx((()=>[s.renderSlot(e.$slots,"otpInput")])),loginInput:s.withCtx((()=>[s.renderSlot(e.$slots,"loginInput")])),_:3},16)):s.createCommentVNode("",!0)])),_:3}),s.unref(c)?(s.openBlock(),s.createElementBlock("div",wa,s.toDisplayString(s.unref(i)("invalid-app-id")),1)):s.createCommentVNode("",!0)],64))}});exports.AuthRoute=ua,exports.LoginRoute=da,exports.RegisterRoute=pa,exports._sfc_main=Ia,exports.useElementSetup=function(e){function t(){const{updateAppId:t}=s.useAppId();e.appId&&t(e.appId);const{updateDefaultCountryCode:n}=s.useDefaultCountryCode();n(e.defaultCountryCode);const{setBeforeAuth:a,setOnSuccess:i,setOnEvent:o}=L();a(e.beforeAuth),i(e.onSuccess),o(e.onEvent)}t(),s.onBeforeUpdate((()=>{t()}));const{languageLoading:n}=s.useStoreLocale(e),a=s.ref();return s.useIntlTelInput(a),{languageLoading:n,containerRef:a}};
//# 
