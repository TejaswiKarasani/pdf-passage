"use strict";var h=Object.create;var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var A=Object.getOwnPropertyNames;var v=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var O=(r,e)=>{for(var t in e)d(r,t,{get:e[t],enumerable:!0})},y=(r,e,t,a)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of A(e))!w.call(r,i)&&i!==t&&d(r,i,{get:()=>e[i],enumerable:!(a=S(e,i))||a.enumerable});return r};var K=(r,e,t)=>(t=r!=null?h(v(r)):{},y(e||!r||!r.__esModule?d(t,"default",{value:r,enumerable:!0}):t,r)),B=r=>y(d({},"__esModule",{value:!0}),r);var s=(r,e,t)=>new Promise((a,i)=>{var o=l=>{try{p(t.next(l))}catch(g){i(g)}},P=l=>{try{p(t.throw(l))}catch(g){i(g)}},p=l=>l.done?a(l.value):Promise.resolve(l.value).then(o,P);p((t=t.apply(r,e)).next())});var T={};O(T,{CreateCredentialUtils:()=>c,GetCredentialUtils:()=>C});module.exports=B(T);var m=(r,e)=>s(void 0,null,function*(){let t,a=new Promise(i=>{t=setTimeout(i,e)});return Promise.race([r,a]).then(i=>(clearTimeout(t),i))});var n=class{static encodeBytes(e){let a=btoa(String.fromCharCode(...new Uint8Array(e))).replace(/\+/g,"-").replace(/\//g,"_");return f(a)}static decodeBytes(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),a=f(t);return Uint8Array.from(atob(a),o=>o.charCodeAt(0))}},f=r=>{let e=r.indexOf("=");return r.slice(0,e===-1?r.length:e)};var c=class{static createCredentialAvailable(){return s(this,null,function*(){let e={securityKey:!1,platform:!1,isAvailable:!1};return window.PublicKeyCredential&&(e.securityKey=!0,e.isAvailable=!0,yield m(window.PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable().then(t=>{e.platform=t}).catch(()=>console.log("Something went wrong.")),1e3)),e})}static parsePublicKey(e){if(e.challenge=n.decodeBytes(e.challenge.toString()),e.user.id=n.decodeBytes(e.user.id.toString()),e.excludeCredentials)for(let t=0;t<e.excludeCredentials.length;t++){let a=e.excludeCredentials[t];a.id=n.decodeBytes(a.id.toString())}return e}static getTransports(e){let t=[];return e.response.getTransports&&typeof e.response.getTransports=="function"&&(t=e.response.getTransports()),t}static createCredential(e){return s(this,null,function*(){let t={credential:null,transports:[]},a=this.parsePublicKey(e),i=yield navigator.credentials.create({publicKey:a}).then(o=>o);return i==null||(t.credential=i,t.transports=this.getTransports(i)),t})}};var b=K(require("ua-parser-js"),1),u=class{constructor(){this.userAgent=new b.default}getSyncedCredential(){return!!(this._isiOSPasskeySupported()||this._isMacPasskeySupported()||this._isChromeSyncedCredential())}getCrossDeviceCredential(){return this.userAgent.getOS().name==="Android"?!1:this.getSyncedCredential()}_isiOSPasskeySupported(){return this.userAgent.getOS().name=="iOS"&&parseFloat(this.userAgent.getOS().version||"")>=16}_isMacPasskeySupported(){return this.userAgent.getBrowser().name=="Safari"&&parseFloat(this.userAgent.getBrowser().version||"")>=16&&this.userAgent.getOS().name=="Mac OS"}_isChromeSyncedCredential(){var a;let e=(a=this.userAgent.getOS().name)!=null?a:"";return((e==null?void 0:e.includes("Windows"))||(e==null?void 0:e.includes("Mac OS"))||(e==null?void 0:e.includes("Android")))&&this.userAgent.getBrowser().name=="Chrome"&&parseFloat(this.userAgent.getBrowser().version||"")>=108}};var C=class{static parsePublicKey(e){if(e.challenge=n.decodeBytes(e.challenge.toString()),e.allowCredentials){for(let t=0;t<e.allowCredentials.length;t++){let a=e.allowCredentials[t];a.id=n.decodeBytes(a.id.toString())}return e}return e}static getCredential(e,t){return s(this,null,function*(){return yield navigator.credentials.get({mediation:t==null?void 0:t.mediation,signal:t==null?void 0:t.signal,publicKey:this.parsePublicKey(e)}).then(i=>i)})}static getCredentialAvailable(){return s(this,null,function*(){let e={securityKey:!1,platform:!1,syncedCredential:!1,crossDeviceCredential:!1,conditionalUI:!1,isAvailable:!1},t=yield c.createCredentialAvailable();if(e.securityKey=t.securityKey,e.platform=t.platform,e.isAvailable=t.isAvailable,!e.securityKey)return e;e.conditionalUI=yield this._isConditionalMediationAvailable();let a=new u;return e.syncedCredential=a.getSyncedCredential(),e.crossDeviceCredential=a.getCrossDeviceCredential(),e})}static _isConditionalMediationAvailable(){return s(this,null,function*(){return PublicKeyCredential.isConditionalMediationAvailable?yield PublicKeyCredential.isConditionalMediationAvailable():!1})}};0&&(module.exports={CreateCredentialUtils,GetCredentialUtils});
//# sourceMappingURL=index.cjs.map